<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <title>Bridgy</title>
  <link href="/static/style.css" rel="stylesheet" type="text/css" />

  <!-- google analytics -->
  <script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-11785301-2']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

  </script>
</head>

<body>

{# TODO: javascript to set browser location to / so that reloads are harmless #}

<div class="messages">
{% for msg in msgs %}
  <p>{{ msg }}</p>
{% endfor %}
</div>

<div id="navbar">
  <p> 
  {% if user %}
    {{ nickname }} | <a href="{{ logout_url }}">Sign out</a>
  {% else %}
    <a href="/register">Sign in</a>
  {% endif %}
  </p>
</div>

<div id="header">
  <img id="logo" src="/static/bridgy_logo.jpg" />
  <p id="title"><span>Bridgy</span></p>
</div>

<div id="body">

<p>Got a blog? Share your blog posts on social networks? Wish comments on those
shared posts also showed up on your blog? Bridgy copies them back for you.</p>

{% if user %}
<p><b>Your sources:</b></p>
<div class="section">
  {# TODO: paging #}
  <table id="sources">
  {% for source in sources %}
    <tr><td>
        <a href="{{ source.url }}">
          <img class="source" src="{{ source.picture }}" /></a>
      </td><td>
        <a href="{{ source.url }}">{{ source.display_name }}</a>
      </td><td>
        ({{ source.type_display_name }})
      </td><td>
        <!-- TODO: make this generic across source types. need unique id across
             all source types, and way to look it up. (webfinger.) same w/dests.
          -->
        <form method="post" action="{{ source.delete_url }}">
          <input name="key_name" type="hidden" value="{{ source.key.name }}" />
          <input type="image" src="static/trash_can.png" title="Delete" />
        </form>
    </td></tr>
  {% endfor %}
  </table>

  <form method="post" action="/facebook/add">
    <input type="submit" value="Add Facebook">
  </form>

  <form method="post" action="/googleplus/add">
    <input type="submit" value="Add Google+">
  </form>

  {% if available_twitter_dests %}
    <form method="post" action="/twitter/add">
      <input type="submit" value="Add Twitter">
      <label for="add-twitter-url">for base URL</label>
      <select id="add-twitter-url" name="url">
        {% for dest in available_twitter_dests %}
        <option value="{{ dest.url }}">{{ dest.display_name }}</option>
        {% endfor %}
      </select>
    </form>
  {% else %}
    <p class="disabled">
      {% if dests %}
        All destinations have Twitter sources.
      {% else %}
        Add a destination to enable Twitter.
      {% endif %}
    </p>
  {% endif %}

</div>

<p><b>Your destinations:</b></p>
<div class="section">
  <table id="destinations">
  {% for dest in dests %}
    <tr><td>
        <a href="{{ dest.url }}">
          <img class="dest" src="{{ dest.favicon_url }}" /></a>
      </td><td>
        <a href="{{ dest.url }}">{{ dest.display_name }}</a>
      </td><td>
        ({{ dest.type_display_name }})
      </td><td>
      <form method="post" action="/wordpress/delete">
        <input name="name" type="hidden" value="{{ dest.key.name }}" />
        <input type="image" src="static/trash_can.png" title="Delete" />
      </form>
    </td></tr>
  {% endfor %}
  </table>

  <form method="post" action="/wordpress/add">
    <table><tr><td>
          <label for="xmlrpc_url">Base URL</label>
        </td><td>
          <input id="url" name="url" type="text" />
      </td></tr><tr><td>
          <label for="xmlrpc_url">XMLRPC URL</label>
        </td><td>
          <input id="xmlrpc_url" name="xmlrpc_url" type="text" />
    </td></tr></table>
    <input type="submit" value="Add Wordpress">
  </form>
</div>

{% else %}
  <p>Please <a href="/register">sign in</a>.</p>
{% endif %}
</div>

<div id="bottom"></div>

<div id="footer">
  <a href="http://snarfed.org/2012-01-08_bridgy_launched">About</a>
  | <a href="http://snarfed.org/about">Contact</a>
  | <a href="https://github.com/snarfed/bridgy">Source</a>
  | <a href="http://code.google.com/appengine/">
    <img src="/static/appengine_button_noborder.gif" /></a>
</div>

</body>
</html>

